<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="dark light" />
    <meta name="theme-color" content="#f5f7fb" />

    <title>AuraNet</title>
    <meta
      name="description"
      content="Activity logger + aura blending + paper sketch map."
    />

    <link rel="icon" href="./favicon.svg" type="image/svg+xml" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"
      rel="stylesheet"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <link rel="manifest" href="./app.webmanifest" />
    <link rel="apple-touch-icon" href="./favicon.svg" />
    <link rel="stylesheet" href="./styles.css" />

    <script
      defer
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script defer src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <script defer src="./firebase-config.js"></script>
    <script defer src="./app.js"></script>
  </head>
  <body>
    <a class="skipLink" href="#mainContent" data-i18n="skip_main">Skip to main content</a>
    <div class="bg" aria-hidden="true"></div>
    <div class="pixelStage" aria-hidden="true">
      <span class="pixelSprite pixelSprite--ship"></span>
      <span class="pixelSprite pixelSprite--star"></span>
      <span class="pixelSprite pixelSprite--orb"></span>
      <span class="pixelSprite pixelSprite--heart"></span>
    </div>

    <header class="shell">
      <div class="topbar">
        <div class="brand">
          <div class="mark" aria-hidden="true">
            <span class="mark__glyph">A</span>
          </div>
          <div class="brand__text">
            <div class="brand__name">AuraNet</div>
          </div>
        </div>
        <div class="hud">
          <div class="hud__clock" id="clock" aria-label="Local time"></div>
          <label class="lang" aria-label="Language">
            <span class="lang__label" data-i18n="ui_language">Language</span>
            <select class="lang__select" id="langSelect">
              <option value="en">English</option>
              <option value="zh-Hant">繁體中文</option>
              <option value="ja">日本語</option>
            </select>
          </label>
          <div class="auth" id="authWrap" aria-live="polite">
            <div class="pill pill--muted auth__status" id="authPill" data-i18n="auth_not_configured">
              Firebase login not configured
            </div>
            <button class="btn btn--primary btn--compact auth__login" type="button" id="authLogin" hidden>
              <span data-i18n="auth_login_google">Sign in with Google</span>
            </button>
            <button class="btn btn--ghost btn--compact auth__logout" type="button" id="authLogout" hidden>
              <span data-i18n="auth_logout">Sign out</span>
            </button>
          </div>
          <div class="pill pill--ok" id="netPill" data-i18n="net_online">
            ONLINE
          </div>
          <div
            class="pill pill--ok"
            id="storagePill"
            title="Saved locally in your browser"
          >
            LOCAL SAVE: OK
          </div>
        </div>
      </div>

      <div class="headerStrip">
        <nav
          class="sectionTabs"
          id="sectionTabs"
          aria-label="Primary sections"
        >
          <button
            class="sectionTabs__btn"
            type="button"
            id="sectionTabActivity"
            data-section-target="activitySection"
            aria-pressed="false"
          >
            <span data-i18n="section_activity">Activity Logger</span>
          </button>
          <button
            class="sectionTabs__btn"
            type="button"
            id="sectionTabMap"
            data-section-target="mapSection"
            aria-pressed="true"
          >
            <span data-i18n="section_map">Live Map</span>
          </button>
          <button
            class="sectionTabs__btn"
            type="button"
            id="sectionTabMarket"
            data-section-target="marketplaceSection"
            aria-pressed="false"
          >
            <span data-i18n="section_marketplace">Tasks &amp; Market</span>
          </button>
        </nav>

        <div class="workspaceTools">
          <button class="btn btn--ghost btn--compact" type="button" id="appInstallBtn" hidden>
            <span data-i18n="install_app">Install app</span>
          </button>
          <button class="btn btn--ghost btn--compact" type="button" id="dataExportBtn">
            <span data-i18n="data_export">Export data</span>
          </button>
          <button class="btn btn--ghost btn--compact" type="button" id="dataImportBtn">
            <span data-i18n="data_import">Import data</span>
          </button>
          <input type="file" id="dataImportInput" accept="application/json" hidden />
        </div>
      </div>

      <div class="quickActions" id="quickActions" role="group" aria-label="Quick actions">
        <div class="quickActions__label" data-i18n="quick_actions_label">Quick actions</div>
        <div class="quickActions__list">
          <button class="quickActionBtn" type="button" id="qaStartActivity">
            <span data-i18n="quick_start_activity">Start activity</span>
          </button>
          <button class="quickActionBtn" type="button" id="qaLocateMap">
            <span data-i18n="quick_locate_me">Center map</span>
          </button>
          <button class="quickActionBtn" type="button" id="qaPostTask">
            <span data-i18n="quick_post_task">Post task</span>
          </button>
          <button class="quickActionBtn" type="button" id="qaPostService">
            <span data-i18n="quick_post_service">Post service</span>
          </button>
          <button class="quickActionBtn" type="button" id="qaScheduleEvent">
            <span data-i18n="quick_schedule_event">Schedule event</span>
          </button>
        </div>
      </div>
    </header>

    <main class="shell" id="mainContent">
      <div class="grid">
        <section class="card card--timer focusScope focusScope--activity" id="activitySection" aria-labelledby="activityTitle" tabindex="-1">
          <div class="card__head">
            <h2 class="h1" id="activityTitle" data-i18n="activity_title">
              Activity Logger
            </h2>
            <div class="pill pill--muted" id="auraPill">Aura</div>
          </div>

          <div class="activity focusTarget" id="focusActivityNow" data-focus-id="activityNow">
            <div class="activity__time" id="activityTime">00:00:00</div>
            <div
              class="activity__hint"
              id="activityHint"
              data-i18n="activity_hint_idle"
            >
              Log what you’re doing. Your aura blends over time.
            </div>
          </div>

          <details class="onboard focusTarget" id="onboardPanel" data-focus-id="onboardPanel">
            <summary class="onboard__summary">
              <span class="onboard__title" data-i18n="onboard_title">Quick start</span>
            </summary>
            <div class="onboard__body">
              <div class="onboard__desc" data-i18n="onboard_desc">
                Core flow in less than a minute.
              </div>
              <ol class="onboard__list">
                <li class="onboard__item" data-i18n="onboard_step_1">
                  Log an activity and let your aura blend automatically.
                </li>
                <li class="onboard__item" data-i18n="onboard_step_2">
                  Choose who can see your aura: everyone, nearby area, or trusted contacts.
                </li>
                <li class="onboard__item" data-i18n="onboard_step_3">
                  Use map filters to focus on people, events, or services.
                </li>
                <li class="onboard__item" data-i18n="onboard_step_4">
                  Post tasks or services and manage responses from one place.
                </li>
              </ol>
            </div>
          </details>

          <form class="activityForm focusTarget" id="activityForm" data-focus-id="activityForm" autocomplete="off">
            <div class="activityForm__row">
              <label class="field">
                <span class="field__label" data-i18n="activity_label">
                  Activity
                </span>
                <input
                  class="input"
                  id="activityText"
                  name="text"
                  placeholder="Work, commute, gym, coffee…"
                  data-i18n-placeholder="activity_placeholder"
                  minlength="1"
                  maxlength="60"
                  required
                />
                <div class="activityAssist" aria-label="Activity helpers">
                  <div class="activityColorPreview" id="activityColorPreview" aria-live="polite"></div>
                  <div class="activitySuggest" id="activitySuggest" role="listbox" hidden></div>
                </div>
              </label>
            </div>

            <label class="toggle">
              <input type="checkbox" id="activityShowAura" />
              <span data-i18n="activity_show_aura_toggle">
                Show my aura on map while active
              </span>
            </label>

            <label class="toggle">
              <input type="checkbox" id="idleShowAura" />
              <span data-i18n="idle_show_aura_toggle">
                Show my aura on map while idle
              </span>
            </label>

            <div class="visBlock" aria-label="Aura visibility controls">
              <div class="visBlock__label" data-i18n="visibility_label">
                Visibility
              </div>
              <div class="seg visBlock__seg" id="visibilitySeg" role="radiogroup" aria-label="Aura visibility">
                <button class="seg__btn" type="button" data-vis="everyone" aria-selected="true">
                  <span data-i18n="visibility_everyone">Everyone</span>
                </button>
                <button class="seg__btn" type="button" data-vis="area" aria-selected="false">
                  <span data-i18n="visibility_area">Nearby radius</span>
                </button>
                <button class="seg__btn" type="button" data-vis="connected" aria-selected="false">
                  <span data-i18n="visibility_connected">Trusted contacts</span>
                </button>
              </div>

              <div class="visDetail" id="visibilityDetail">
                <div class="visArea" id="visArea" hidden>
                  <label class="field" for="areaRadius">
                    <span class="field__label" data-i18n="visibility_area_radius_label">
                      Visible area
                    </span>
                    <input
                      class="range"
                      type="range"
                      id="areaRadius"
                      min="10"
                      max="500"
                      step="10"
                      value="100"
                    />
                    <div class="rangeMeta" aria-live="polite">
                      <span class="rangeMeta__value" id="areaRadiusValue">100m</span>
                      <span class="rangeMeta__min">10m</span>
                      <span class="rangeMeta__max">500m</span>
                    </div>
                  </label>
                  <div class="visArea__note" id="visAreaNote"></div>
                </div>

                <div class="visApproved" id="visApproved" hidden>
                  <div class="visRoom" id="visRoom">
                    <label class="field">
                      <span class="field__label" data-i18n="room_label">
                        Room
                      </span>
                      <input
                        class="input"
                        id="visRoomCode"
                        placeholder="Room code"
                        data-i18n-placeholder="room_placeholder"
                        minlength="1"
                        maxlength="36"
                      />
                    </label>
                    <div class="visRoom__actions">
                      <button class="btn btn--ghost" type="button" id="visRoomJoin">
                        <span data-i18n="room_join">Join</span>
                      </button>
                      <button class="btn btn--ghost" type="button" id="visRoomLeave" hidden>
                        <span data-i18n="room_leave">Leave</span>
                      </button>
                      <span class="badge" id="visRoomState">ROOM: OFF</span>
                    </div>
                  </div>

                  <div class="visApproved__row">
                    <label class="field">
                      <span class="field__label" data-i18n="approved_label">
                        Approved contacts
                      </span>
                      <input
                        class="input"
                        id="approvedInput"
                        placeholder="@handle"
                        data-i18n-placeholder="approved_placeholder"
                        minlength="1"
                        maxlength="32"
                      />
                    </label>
                    <button class="btn btn--ghost" type="button" id="approvedAdd">
                      <span data-i18n="approved_add">Add</span>
                    </button>
                  </div>
                  <ul class="approvedList" id="approvedList" aria-label="Approved contacts"></ul>
                </div>
              </div>
            </div>

            <div class="activityForm__actions">
              <button class="btn btn--primary" type="button" id="activityStart">
                <span data-i18n="activity_start">Start</span>
              </button>
              <button class="btn btn--ghost" type="button" id="activityStop" disabled>
                <span data-i18n="activity_stop_log">Stop & log</span>
              </button>
            </div>
          </form>

          <div class="auraRow" aria-label="Long-term aura color">
            <div class="auraSwatch" id="auraSwatch" aria-hidden="true"></div>
            <div class="auraMeta">
              <div class="auraMeta__title" data-i18n="aura_long_term_title">
                Long-term aura
              </div>
              <div class="auraMeta__value" id="auraValue">—</div>
            </div>
          </div>

          <div class="auraViz focusTarget" data-focus-id="auraViz" aria-label="Aura composition breakdown">
            <div class="auraChart" aria-hidden="true">
              <svg
                class="auraChart__svg"
                id="auraChart"
                viewBox="0 0 120 120"
                width="140"
                height="140"
              ></svg>
              <div class="auraChart__center">
                <div class="auraChart__label" data-i18n="aura_chart_label">
                  Aura
                </div>
                <div class="auraChart__value" id="auraHex">—</div>
              </div>
            </div>
            <ul
              class="auraLegend"
              id="auraLegend"
              aria-label="Aura components"
            ></ul>
          </div>

          <ul class="activityList focusTarget" id="activityList" data-focus-id="activityList" aria-label="Recent activities"></ul>
        </section>

        <section class="card card--map focusScope focusScope--map" id="mapSection" aria-labelledby="mapTitle" tabindex="-1">
          <div class="card__head">
            <h2 class="h1" id="mapTitle" data-i18n="map_title">
              Live Aura Map
            </h2>
            <div class="stats" id="mapStatus" data-i18n="map_loading">
              Loading map…
            </div>
          </div>

          <div class="mapWrap focusTarget" data-focus-id="mapWrap" aria-label="Map canvas with paper sketch effect">
            <div
              id="paperMap"
              class="mapCanvas"
              role="application"
              aria-label="Interactive map"
            >
              <div class="mapPaper" aria-hidden="true"></div>
              <div class="mapVignette" aria-hidden="true"></div>
            </div>
            <div class="mapHud" id="mapHud" hidden>
              <div class="mapHud__text" id="mapHudText" aria-live="polite"></div>
              <button class="btn btn--ghost mapHud__cancel" type="button" id="mapHudCancel">
                <span data-i18n="map_pick_cancel">Cancel</span>
              </button>
            </div>
          </div>

          <div class="mapFilters focusTarget" id="mapLayerFilters" data-focus-id="mapFilters" role="group" aria-label="Available on map">
            <div class="mapFilters__label" data-i18n="map_filters_label">Available on map</div>
            <div class="mapFilters__chips">
              <button class="mapFilterBtn" type="button" id="mapFilterPeople" aria-pressed="true">
                <span data-i18n="map_filter_people">People</span>
              </button>
              <button class="mapFilterBtn" type="button" id="mapFilterEvents" aria-pressed="true">
                <span data-i18n="map_filter_events">Event</span>
              </button>
              <button class="mapFilterBtn" type="button" id="mapFilterServices" aria-pressed="true">
                <span data-i18n="map_filter_services">Service</span>
              </button>
            </div>
          </div>

          <div class="mapBar focusTarget" data-focus-id="mapBar">
            <div class="mapActions">
              <button class="btn btn--primary" type="button" id="mapLocate">
                <span data-i18n="map_locate">My location</span>
              </button>
              <button class="btn btn--ghost" type="button" id="mapReset">
                <span data-i18n="map_reset">Reset view</span>
              </button>
            </div>
            <div class="mapMeta">
              <span class="badge" id="mapGps">GPS: OFF</span>
              <span class="badge" id="mapVis">VIS: EVERYONE</span>
              <span class="badge badge--ok" id="mapAuraCount">AURAS: 0</span>
            </div>
          </div>

          <div class="mapDm focusTarget" id="mapDm" data-focus-id="mapDm" hidden>
            <div class="mapDm__head">
              <div class="mapDm__title" data-i18n="map_msg_title">Map messages</div>
              <div class="mapDm__target" id="mapDmTarget">—</div>
            </div>
            <div class="mapDm__list" id="mapDmList" aria-live="polite"></div>
            <form class="mapDm__form" id="mapDmForm" autocomplete="off">
              <input
                class="input mapDm__input"
                id="mapDmInput"
                maxlength="240"
                placeholder="Send a message..."
                data-i18n-placeholder="map_msg_placeholder"
              />
              <button class="btn btn--primary btn--compact" type="submit" id="mapDmSend">
                <span data-i18n="map_msg_send">Send</span>
              </button>
            </form>
          </div>
        </section>

        <section
          class="card card--wide focusScope focusScope--market"
          id="marketplaceSection"
          aria-labelledby="marketplaceTitle"
          tabindex="-1"
        >
          <div class="card__head">
            <h2 class="h1" id="marketplaceTitle" data-i18n="marketplace_title">
              Marketplace
            </h2>
            <div class="stats" data-i18n="marketplace_sub">
              Post tasks, listings, and scheduled activities.
            </div>
          </div>

          <div class="marketTabs focusTarget" id="marketTabs" data-focus-id="marketTabs" role="tablist" aria-label="Marketplace tabs">
            <button
              class="tabBtn"
              type="button"
              data-tab="tasks"
              id="marketTabTasks"
              role="tab"
              aria-controls="tabTasks"
              aria-selected="true"
            >
              <span class="tabBtn__label" data-i18n="tab_tasks">Tasks</span>
              <span class="tabBtn__count" id="marketTabTasksCount" aria-hidden="true" hidden>0</span>
            </button>
            <button
              class="tabBtn"
              type="button"
              data-tab="market"
              id="marketTabMarket"
              role="tab"
              aria-controls="tabMarket"
              aria-selected="false"
              tabindex="-1"
            >
              <span class="tabBtn__label" data-i18n="tab_market">Market</span>
              <span class="tabBtn__count" id="marketTabMarketCount" aria-hidden="true" hidden>0</span>
            </button>
            <button
              class="tabBtn"
              type="button"
              data-tab="events"
              id="marketTabEvents"
              role="tab"
              aria-controls="tabEvents"
              aria-selected="false"
              tabindex="-1"
            >
              <span class="tabBtn__label" data-i18n="tab_events">Scheduled</span>
              <span class="tabBtn__count" id="marketTabEventsCount" aria-hidden="true" hidden>0</span>
            </button>
          </div>

          <div class="marketTab" id="tabTasks" role="tabpanel" aria-labelledby="marketTabTasks">
            <div class="panelHead">
              <div class="panelHead__title" data-i18n="tasks_title">Tasks</div>
              <div class="pill pill--muted" id="taskFeePill">FEE: 10%</div>
            </div>

            <details class="drop focusTarget" id="dropTasksPost" data-focus-id="dropTasksPost">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_post_task">Post task</span>
              </summary>
              <div class="drop__body">
                <form class="taskForm" id="taskForm" autocomplete="off">
                  <div class="taskForm__row">
                    <label class="field">
                      <span class="field__label" data-i18n="task_label">Task</span>
                      <input
                        class="input"
                        id="taskText"
                        name="task"
                        placeholder="Pick up coffee, deliver package…"
                        data-i18n-placeholder="task_placeholder"
                        minlength="2"
                        maxlength="72"
                        required
                      />
                    </label>
                    <label class="field">
                      <span class="field__label" data-i18n="task_reward_label">Reward (USD)</span>
                      <input
                        class="input"
                        id="taskReward"
                        name="reward"
                        type="number"
                        inputmode="decimal"
                        min="1"
                        max="9999"
                        step="1"
                        value="20"
                        required
                      />
                    </label>
                  </div>

                  <div class="taskForm__row taskForm__row--pick">
                    <div class="taskPick">
                      <div class="taskPick__actions">
                        <button class="btn btn--ghost" type="button" id="taskPickStart">
                          <span data-i18n="task_pick_start">Pick start</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="taskUseMyStart">
                          <span data-i18n="task_use_my_area">Use my area</span>
                        </button>
                      </div>
                      <div class="taskPick__meta" id="taskStartMeta" data-i18n="task_start_unset">
                        Start: not set
                      </div>
                    </div>
                    <div class="taskPick">
                      <div class="taskPick__actions">
                        <button class="btn btn--ghost" type="button" id="taskPickDest">
                          <span data-i18n="task_pick_dest">Pick destination</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="taskClearRoute">
                          <span data-i18n="task_clear_route">Clear</span>
                        </button>
                      </div>
                      <div class="taskPick__meta" id="taskDestMeta" data-i18n="task_dest_unset">
                        Destination: not set
                      </div>
                    </div>
                  </div>

                  <div class="taskForm__row taskForm__row--ranges">
                    <label class="field" for="taskTimeLimit">
                      <span class="field__label" data-i18n="task_time_limit_label">
                        Time limit
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="taskTimeLimit"
                        min="15"
                        max="360"
                        step="15"
                        value="60"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="taskTimeLimitValue">60m</span>
                        <span class="rangeMeta__min">15m</span>
                        <span class="rangeMeta__max">360m</span>
                      </div>
                    </label>

                    <label class="field" for="taskDistanceLimit">
                      <span class="field__label" data-i18n="task_distance_limit_label">
                        Distance limit
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="taskDistanceLimit"
                        min="50"
                        max="5000"
                        step="50"
                        value="800"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="taskDistanceLimitValue">800m</span>
                        <span class="rangeMeta__min">50m</span>
                        <span class="rangeMeta__max">5000m</span>
                      </div>
                    </label>
                  </div>

                  <div class="taskForm__actions">
                    <button class="btn btn--primary" type="submit" id="taskPost">
                      <span data-i18n="task_post">Post task</span>
                    </button>
                  </div>
                </form>
              </div>
            </details>

            <details class="drop focusTarget" id="dropTasksList" data-focus-id="dropTasksList">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_task_list">Tasks</span>
                <span class="drop__count" id="taskListCount">0</span>
              </summary>
              <div class="drop__body">
                <div class="listTools" aria-label="Task filters">
                  <label class="field listTools__field listTools__field--grow">
                    <span class="sr-only" data-i18n="filter_search_tasks_label">Search tasks</span>
                    <input
                      class="input input--search"
                      id="taskSearchInput"
                      type="search"
                      data-i18n-placeholder="filter_task_search_placeholder"
                      placeholder="Search tasks…"
                      maxlength="72"
                    />
                  </label>
                  <label class="field listTools__field">
                    <span class="sr-only" data-i18n="filter_task_status_label">Task status</span>
                    <select class="select" id="taskStatusFilter">
                      <option value="all" data-i18n="filter_task_status_all">All status</option>
                      <option value="open" data-i18n="filter_task_status_open">Open</option>
                      <option value="accepted" data-i18n="filter_task_status_accepted">Accepted</option>
                      <option value="completed" data-i18n="filter_task_status_completed">Completed</option>
                      <option value="closed" data-i18n="filter_task_status_closed">Closed</option>
                    </select>
                  </label>
                  <button class="btn btn--ghost btn--compact listTools__clear" type="button" id="taskFilterClear">
                    <span data-i18n="filter_clear">Clear</span>
                  </button>
                </div>
                <div class="listTools__meta" id="taskFilterMeta" aria-live="polite"></div>
                <ul class="taskList" id="taskList" aria-label="Tasks"></ul>
              </div>
            </details>
          </div>

          <div class="marketTab" id="tabMarket" role="tabpanel" aria-labelledby="marketTabMarket" hidden>
            <div class="panelHead">
              <div class="panelHead__title" data-i18n="market_title">Market</div>
              <div class="pill pill--muted" id="marketPill" data-i18n="market_pill">LOCAL</div>
            </div>

            <details class="drop focusTarget" id="dropMarketPost" data-focus-id="dropMarketPost">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_post_market">Post product/service</span>
              </summary>
              <div class="drop__body">
                <form class="marketForm" id="marketForm" autocomplete="off">
                  <div class="marketForm__row">
                    <div class="seg" id="marketKind" role="radiogroup" aria-label="Market kind">
                      <button class="seg__btn" type="button" data-kind="product" aria-selected="true">
                        <span data-i18n="market_kind_product">Product</span>
                      </button>
                      <button class="seg__btn" type="button" data-kind="service" aria-selected="false">
                        <span data-i18n="market_kind_service">Service</span>
                      </button>
                    </div>
                  </div>

                  <div class="marketForm__row">
                    <label class="field">
                      <span class="field__label" data-i18n="market_label">Post</span>
                      <input
                        class="input"
                        id="marketText"
                        name="market"
                        placeholder="Sell a bike, offer tutoring…"
                        data-i18n-placeholder="market_placeholder"
                        minlength="2"
                        maxlength="72"
                        required
                      />
                    </label>
                    <label class="field">
                      <span class="field__label" data-i18n="market_price_label">Price (USD)</span>
                      <input
                        class="input"
                        id="marketPrice"
                        name="price"
                        type="number"
                        inputmode="decimal"
                        min="0"
                        max="99999"
                        step="1"
                        value="25"
                        required
                      />
                    </label>
                  </div>

                  <div class="marketForm__row marketForm__row--pick">
                    <div class="taskPick taskPick--single">
                      <div class="taskPick__actions">
                        <button class="btn btn--ghost" type="button" id="marketPickLocation">
                          <span data-i18n="market_pick_location">Pick location</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="marketUseMyLocation">
                          <span data-i18n="market_use_my_area">Use my area</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="marketClearLocation">
                          <span data-i18n="market_clear_location">Clear</span>
                        </button>
                      </div>
                      <div class="taskPick__meta" id="marketLocMeta" data-i18n="market_loc_unset">
                        Location: not set
                      </div>
                    </div>
                  </div>

                  <div class="marketForm__row marketForm__row--ranges">
                    <label class="field" for="marketTimeLimit">
                      <span class="field__label" data-i18n="market_time_limit_label">
                        Time limit
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="marketTimeLimit"
                        min="15"
                        max="360"
                        step="15"
                        value="180"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="marketTimeLimitValue">3h</span>
                        <span class="rangeMeta__min">15m</span>
                        <span class="rangeMeta__max">360m</span>
                      </div>
                    </label>

                    <label class="field" for="marketDistanceLimit">
                      <span class="field__label" data-i18n="market_distance_limit_label">
                        Distance limit
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="marketDistanceLimit"
                        min="50"
                        max="5000"
                        step="50"
                        value="1200"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="marketDistanceLimitValue">1200m</span>
                        <span class="rangeMeta__min">50m</span>
                        <span class="rangeMeta__max">5000m</span>
                      </div>
                    </label>
                  </div>

                  <div class="taskForm__actions">
                    <button class="btn btn--primary" type="submit" id="marketPost">
                      <span data-i18n="market_post">Post</span>
                    </button>
                  </div>
                </form>
              </div>
            </details>

            <details class="drop focusTarget" id="dropMarketList" data-focus-id="dropMarketList">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_market_list">Market posts</span>
                <span class="drop__count" id="marketListCount">0</span>
              </summary>
              <div class="drop__body">
                <div class="listTools" aria-label="Market filters">
                  <label class="field listTools__field listTools__field--grow">
                    <span class="sr-only" data-i18n="filter_search_market_label">Search listings</span>
                    <input
                      class="input input--search"
                      id="marketSearchInput"
                      type="search"
                      data-i18n-placeholder="filter_market_search_placeholder"
                      placeholder="Search listings…"
                      maxlength="72"
                    />
                  </label>
                  <label class="field listTools__field">
                    <span class="sr-only" data-i18n="filter_market_kind_label">Listing type</span>
                    <select class="select" id="marketKindFilter">
                      <option value="all" data-i18n="filter_market_kind_all">All types</option>
                      <option value="product" data-i18n="filter_market_kind_product">Product</option>
                      <option value="service" data-i18n="filter_market_kind_service">Service</option>
                    </select>
                  </label>
                  <label class="field listTools__field">
                    <span class="sr-only" data-i18n="filter_market_status_label">Listing status</span>
                    <select class="select" id="marketStatusFilter">
                      <option value="all" data-i18n="filter_market_status_all">All status</option>
                      <option value="open" data-i18n="filter_market_status_open">Open</option>
                      <option value="sold" data-i18n="filter_market_status_sold">Sold</option>
                      <option value="closed" data-i18n="filter_market_status_closed">Closed</option>
                    </select>
                  </label>
                  <button class="btn btn--ghost btn--compact listTools__clear" type="button" id="marketFilterClear">
                    <span data-i18n="filter_clear">Clear</span>
                  </button>
                </div>
                <div class="listTools__meta" id="marketFilterMeta" aria-live="polite"></div>
                <ul class="marketList" id="marketList" aria-label="Market posts"></ul>
              </div>
            </details>
          </div>

          <div class="marketTab" id="tabEvents" role="tabpanel" aria-labelledby="marketTabEvents" hidden>
            <div class="panelHead">
              <div class="panelHead__title" data-i18n="events_title">Scheduled</div>
              <div class="pill pill--muted" id="eventsPill" data-i18n="events_pill">AURAS</div>
            </div>

            <details class="drop focusTarget" id="dropEventsPost" data-focus-id="dropEventsPost">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_post_events">Schedule activity</span>
              </summary>
              <div class="drop__body">
                <form class="eventsForm" id="eventsForm" autocomplete="off">
                  <div class="eventsForm__row">
                    <label class="field">
                      <span class="field__label" data-i18n="events_label">Activity</span>
                      <input
                        class="input"
                        id="eventsText"
                        name="event"
                        placeholder="Group coffee, sketch walk…"
                        data-i18n-placeholder="events_placeholder"
                        minlength="2"
                        maxlength="60"
                        required
                      />
                    </label>
                  </div>

                  <div class="eventsForm__row eventsForm__row--pick">
                    <div class="taskPick taskPick--single">
                      <div class="taskPick__actions">
                        <button class="btn btn--ghost" type="button" id="eventsPickLocation">
                          <span data-i18n="events_pick_location">Pick location</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="eventsUseMyLocation">
                          <span data-i18n="events_use_my_area">Use my area</span>
                        </button>
                        <button class="btn btn--ghost" type="button" id="eventsClearLocation">
                          <span data-i18n="events_clear_location">Clear</span>
                        </button>
                      </div>
                      <div class="taskPick__meta" id="eventsLocMeta" data-i18n="events_loc_unset">
                        Location: not set
                      </div>
                    </div>
                  </div>

                  <div class="eventsForm__row eventsForm__row--ranges">
                    <label class="field" for="eventsStartsIn">
                      <span class="field__label" data-i18n="events_starts_in_label">
                        Starts in
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="eventsStartsIn"
                        min="0"
                        max="360"
                        step="15"
                        value="30"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="eventsStartsInValue">30m</span>
                        <span class="rangeMeta__min">0m</span>
                        <span class="rangeMeta__max">360m</span>
                      </div>
                    </label>

                    <label class="field" for="eventsDuration">
                      <span class="field__label" data-i18n="events_duration_label">
                        Duration
                      </span>
                      <input
                        class="range"
                        type="range"
                        id="eventsDuration"
                        min="15"
                        max="180"
                        step="15"
                        value="60"
                      />
                      <div class="rangeMeta" aria-live="polite">
                        <span class="rangeMeta__value" id="eventsDurationValue">60m</span>
                        <span class="rangeMeta__min">15m</span>
                        <span class="rangeMeta__max">180m</span>
                      </div>
                    </label>
                  </div>

                  <div class="taskForm__actions">
                    <button class="btn btn--primary" type="submit" id="eventsPost">
                      <span data-i18n="events_post">Schedule</span>
                    </button>
                  </div>
                </form>
              </div>
            </details>

            <details class="drop focusTarget" id="dropEventsList" data-focus-id="dropEventsList">
              <summary class="drop__summary">
                <span class="drop__label" data-i18n="drop_events_list">Scheduled activities</span>
                <span class="drop__count" id="eventsListCount">0</span>
              </summary>
              <div class="drop__body">
                <div class="listTools" aria-label="Scheduled filters">
                  <label class="field listTools__field listTools__field--grow">
                    <span class="sr-only" data-i18n="filter_search_events_label">Search activities</span>
                    <input
                      class="input input--search"
                      id="eventsSearchInput"
                      type="search"
                      data-i18n-placeholder="filter_events_search_placeholder"
                      placeholder="Search activities…"
                      maxlength="72"
                    />
                  </label>
                  <label class="field listTools__field">
                    <span class="sr-only" data-i18n="filter_events_state_label">Activity state</span>
                    <select class="select" id="eventsStateFilter">
                      <option value="all" data-i18n="filter_events_state_all">All state</option>
                      <option value="scheduled" data-i18n="filter_events_state_scheduled">Scheduled</option>
                      <option value="live" data-i18n="filter_events_state_live">Live</option>
                      <option value="ended" data-i18n="filter_events_state_ended">Ended</option>
                      <option value="cancelled" data-i18n="filter_events_state_cancelled">Cancelled</option>
                    </select>
                  </label>
                  <button class="btn btn--ghost btn--compact listTools__clear" type="button" id="eventsFilterClear">
                    <span data-i18n="filter_clear">Clear</span>
                  </button>
                </div>
                <div class="listTools__meta" id="eventsFilterMeta" aria-live="polite"></div>
                <ul class="eventsList" id="eventsList" aria-label="Scheduled activities"></ul>
              </div>
            </details>
          </div>

        </section>
      </div>
    </main>

    <div class="toast toast--global" id="toast" role="status" aria-live="polite" aria-atomic="true" hidden></div>

    <div class="modal" id="roomModal" hidden>
      <div class="modal__backdrop" data-room-close="1" aria-hidden="true"></div>
      <div
        class="modal__panel"
        role="dialog"
        aria-modal="true"
        aria-labelledby="roomTitle"
      >
        <div class="modal__head">
          <div class="modal__title" id="roomTitle" data-i18n="room_title">
            Task room
          </div>
          <button class="btn btn--ghost modal__close" type="button" id="roomClose">
            <span data-i18n="room_close">Close</span>
          </button>
        </div>

        <div class="roomMeta" id="roomMeta" aria-live="polite"></div>

        <div class="roomControls" id="roomControls" aria-label="Room visibility">
          <div class="roomControls__label" data-i18n="room_visibility_label">
            Room visibility
          </div>
          <div class="seg roomControls__seg" id="roomVisibility" role="radiogroup" aria-label="Room visibility options">
            <button class="seg__btn" type="button" data-room-vis="participants" aria-selected="true">
              <span data-i18n="room_vis_participants">Participants</span>
            </button>
            <button class="seg__btn" type="button" data-room-vis="public" aria-selected="false">
              <span data-i18n="room_vis_public">Public</span>
            </button>
          </div>
        </div>

        <div class="roomBody" id="roomBody" aria-label="Messages"></div>

        <form class="roomForm" id="roomForm" autocomplete="off">
          <input
            class="input roomForm__input"
            id="roomMessage"
            name="message"
            placeholder="Message…"
            data-i18n-placeholder="room_message_placeholder"
            minlength="1"
            maxlength="400"
          />
          <input class="sr-only" type="file" id="roomPhoto" accept="image/*" />
          <button class="btn btn--ghost" type="button" id="roomPhotoBtn">
            <span data-i18n="room_photo">Photo</span>
          </button>
          <button class="btn btn--ghost" type="button" id="roomLocBtn">
            <span data-i18n="room_location">Location</span>
          </button>
          <button class="btn btn--primary" type="submit" id="roomSend">
            <span data-i18n="room_send">Send</span>
          </button>
        </form>
      </div>
    </div>

    <div class="modal" id="reviewModal" hidden>
      <div class="modal__backdrop" data-review-close="1" aria-hidden="true"></div>
      <div
        class="modal__panel modal__panel--narrow"
        role="dialog"
        aria-modal="true"
        aria-labelledby="reviewTitle"
      >
        <div class="modal__head">
          <div class="modal__title" id="reviewTitle" data-i18n="review_title">
            Review
          </div>
          <button class="btn btn--ghost modal__close" type="button" id="reviewClose">
            <span data-i18n="room_close">Close</span>
          </button>
        </div>

        <div class="roomMeta" id="reviewMeta" aria-live="polite"></div>

        <form class="reviewForm" id="reviewForm" autocomplete="off">
          <div class="reviewStars" id="reviewStars" role="radiogroup" aria-label="Rating"></div>
          <label class="field">
            <span class="field__label" data-i18n="review_note_label">Note</span>
            <textarea class="input reviewNote" id="reviewNote" name="note" rows="3" maxlength="240" placeholder="Optional note…"></textarea>
          </label>
          <div class="dialog__actions">
            <button class="btn btn--primary" type="submit" id="reviewSubmit">
              <span data-i18n="review_submit">Submit</span>
            </button>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
